{% extends "base.html" %}

{% block content %}

<p class='lead'>This is HOME</p>

{% endblock %}

{% block script %}

<script src="//cdnjs.cloudflare.com/ajax/libs/reconnecting-websocket/1.0.0/reconnecting-websocket.js"></script>
<script>

// websocket scripts
var loc = window.location

//var formData = $("#form")
//var msg_input = $("#id_message")
var wsStart = "ws://"
if (loc.protocol == "https:")
{
	wsStart = "wss://"
}
var endpoint = wsStart + loc.host + loc.pathname


var socket = new ReconnectingWebSocket(endpoint)
socket.onmessage = function(e){
	/*Az tu bude chart js, tak podle nejakeho id poznat, k cemu patri nove dato*/
	var el = document.createElement("p")
	el.innerHTML = e.data
 	document.getElementById("body").appendChild(el)
	console.log("message", e)

	}

socket.onopen = function(e){
	console.log("open", e)
	/*formData.submit(function(event){
		event.preventDefault()
		var msg_text = msg_input.val()
		//var formDataSerialized = formData.serialize()
		var final_data = {"message": msg_text}
		socket.send(JSON.stringify(final_data))
		formData[0].reset()
	})*/
}
socket.onerror =function(e){console.log("error", e)}
socket.onclose =function(e){console.log("close", e)}

</script>
{% endblock %}